
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ws.db.sql_types module &#8212; wiki-scripts 1.2 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wiki-scripts.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ws.interlanguage package" href="ws.interlanguage.html" />
    <link rel="prev" title="ws.db.schema module" href="ws.db.schema.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-ws.db.sql_types">
<span id="ws-db-sql-types-module"></span><h1>ws.db.sql_types module<a class="headerlink" href="#module-ws.db.sql_types" title="Permalink to this headline">¶</a></h1>
<p>Custom types with automatic convertors.</p>
<dl class="docutils">
<dt>Advantages of textual types:</dt>
<dd><ul class="first last simple">
<li>natural for the representation of textual (Unicode) data</li>
</ul>
</dd>
<dt>Disadvantages of textual types:</dt>
<dd><ul class="first last simple">
<li>subject to encoding and collation</li>
</ul>
</dd>
<dt>Advantages of binary types:</dt>
<dd><ul class="first last simple">
<li>complete control over the data representation and conversion to Python
objects</li>
<li>length is in bytes, so there is no storage overhead for ASCII-only data</li>
</ul>
</dd>
</dl>
<p>In MySQL, textual types (<code class="docutils literal notranslate"><span class="pre">*TEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">*CHAR</span></code>) represent Unicode strings, but
all utf8 collations are case-insensitive: <a class="reference external" href="http://stackoverflow.com/a/4558736/4180822">http://stackoverflow.com/a/4558736/4180822</a>
On the other hand, binary types (<code class="docutils literal notranslate"><span class="pre">*BLOB</span></code>, <code class="docutils literal notranslate"><span class="pre">*BINARY</span></code>) are treated as
“byte strings”, i.e. ASCII text with binary collation.</p>
<p>In PostgreSQL, the binary type (bytea) does not represent “strings”, i.e. there
are much less operations and functions defined on bytea then in MySQL for
binary strings. By using the textual types, we also benefit from native
conversion functions in the sqlalchemy driver (e.g. psycopg2).</p>
<dl class="class">
<dt id="ws.db.sql_types.UnicodeBinary">
<em class="property">class </em><code class="descclassname">ws.db.sql_types.</code><code class="descname">UnicodeBinary</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.UnicodeBinary" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.type_api.TypeDecorator</span></code></p>
<dl class="attribute">
<dt id="ws.db.sql_types.UnicodeBinary.impl">
<code class="descname">impl</code><a class="headerlink" href="#ws.db.sql_types.UnicodeBinary.impl" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.sqltypes.UnicodeText</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ws.db.sql_types.MWTimestamp">
<em class="property">class </em><code class="descclassname">ws.db.sql_types.</code><code class="descname">MWTimestamp</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.MWTimestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.type_api.TypeDecorator</span></code></p>
<p>Convertor for TIMESTAMP handling infinite values.</p>
<p>Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code>.</p>
<p>Arguments sent here are passed to the constructor
of the class assigned to the <code class="docutils literal notranslate"><span class="pre">impl</span></code> class level attribute,
assuming the <code class="docutils literal notranslate"><span class="pre">impl</span></code> is a callable, and the resulting
object is assigned to the <code class="docutils literal notranslate"><span class="pre">self.impl</span></code> instance attribute
(thus overriding the class attribute of the same name).</p>
<p>If the class level <code class="docutils literal notranslate"><span class="pre">impl</span></code> is not a callable (the unusual case),
it will be assigned to the same instance attribute ‘as-is’,
ignoring those arguments passed to the constructor.</p>
<p>Subclasses can override this to customize the generation
of <code class="docutils literal notranslate"><span class="pre">self.impl</span></code> entirely.</p>
<dl class="attribute">
<dt id="ws.db.sql_types.MWTimestamp.impl">
<code class="descname">impl</code><em class="property"> = DateTime()</em><a class="headerlink" href="#ws.db.sql_types.MWTimestamp.impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ws.db.sql_types.MWTimestamp.process_bind_param">
<code class="descname">process_bind_param</code><span class="sig-paren">(</span><em>value</em>, <em>dialect</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.MWTimestamp.process_bind_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Python -&gt; database</p>
</dd></dl>

<dl class="method">
<dt id="ws.db.sql_types.MWTimestamp.process_result_value">
<code class="descname">process_result_value</code><span class="sig-paren">(</span><em>value</em>, <em>dialect</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.MWTimestamp.process_result_value" title="Permalink to this definition">¶</a></dt>
<dd><p>database -&gt; python</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ws.db.sql_types.SHA1">
<em class="property">class </em><code class="descclassname">ws.db.sql_types.</code><code class="descname">SHA1</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.SHA1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.type_api.TypeDecorator</span></code></p>
<p>Convertor for the SHA1 hashes.</p>
<p>In MediaWiki they are represented as a base36-encoded number in the database
and as a hexadecimal string in the API.</p>
<p>In both forms the encoded string has to be padded with zeros to fixed
length - 31 digits in base36, 40 digits in hex.</p>
<p>Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code>.</p>
<p>Arguments sent here are passed to the constructor
of the class assigned to the <code class="docutils literal notranslate"><span class="pre">impl</span></code> class level attribute,
assuming the <code class="docutils literal notranslate"><span class="pre">impl</span></code> is a callable, and the resulting
object is assigned to the <code class="docutils literal notranslate"><span class="pre">self.impl</span></code> instance attribute
(thus overriding the class attribute of the same name).</p>
<p>If the class level <code class="docutils literal notranslate"><span class="pre">impl</span></code> is not a callable (the unusual case),
it will be assigned to the same instance attribute ‘as-is’,
ignoring those arguments passed to the constructor.</p>
<p>Subclasses can override this to customize the generation
of <code class="docutils literal notranslate"><span class="pre">self.impl</span></code> entirely.</p>
<dl class="attribute">
<dt id="ws.db.sql_types.SHA1.impl">
<code class="descname">impl</code><em class="property"> = LargeBinary(length=31)</em><a class="headerlink" href="#ws.db.sql_types.SHA1.impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ws.db.sql_types.SHA1.process_bind_param">
<code class="descname">process_bind_param</code><span class="sig-paren">(</span><em>value</em>, <em>dialect</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.SHA1.process_bind_param" title="Permalink to this definition">¶</a></dt>
<dd><p>python -&gt; db</p>
</dd></dl>

<dl class="method">
<dt id="ws.db.sql_types.SHA1.process_result_value">
<code class="descname">process_result_value</code><span class="sig-paren">(</span><em>value</em>, <em>dialect</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.SHA1.process_result_value" title="Permalink to this definition">¶</a></dt>
<dd><p>db -&gt; python</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ws.db.sql_types.JSONEncodedDict">
<em class="property">class </em><code class="descclassname">ws.db.sql_types.</code><code class="descname">JSONEncodedDict</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.JSONEncodedDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.type_api.TypeDecorator</span></code></p>
<p>Represents an immutable structure as a JSON-encoded string.</p>
<p>Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code>.</p>
<p>Arguments sent here are passed to the constructor
of the class assigned to the <code class="docutils literal notranslate"><span class="pre">impl</span></code> class level attribute,
assuming the <code class="docutils literal notranslate"><span class="pre">impl</span></code> is a callable, and the resulting
object is assigned to the <code class="docutils literal notranslate"><span class="pre">self.impl</span></code> instance attribute
(thus overriding the class attribute of the same name).</p>
<p>If the class level <code class="docutils literal notranslate"><span class="pre">impl</span></code> is not a callable (the unusual case),
it will be assigned to the same instance attribute ‘as-is’,
ignoring those arguments passed to the constructor.</p>
<p>Subclasses can override this to customize the generation
of <code class="docutils literal notranslate"><span class="pre">self.impl</span></code> entirely.</p>
<dl class="attribute">
<dt id="ws.db.sql_types.JSONEncodedDict.impl">
<code class="descname">impl</code><a class="headerlink" href="#ws.db.sql_types.JSONEncodedDict.impl" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.sqltypes.UnicodeText</span></code></p>
</dd></dl>

<dl class="method">
<dt id="ws.db.sql_types.JSONEncodedDict.process_bind_param">
<code class="descname">process_bind_param</code><span class="sig-paren">(</span><em>value</em>, <em>dialect</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.JSONEncodedDict.process_bind_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a bound parameter value to be converted.</p>
<p>Subclasses override this method to return the
value that should be passed along to the underlying
<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeEngine</span></code> object, and from there to the
DBAPI <code class="docutils literal notranslate"><span class="pre">execute()</span></code> method.</p>
<p>The operation could be anything desired to perform custom
behavior, such as transforming or serializing data.
This could also be used as a hook for validating logic.</p>
<p>This operation should be designed with the reverse operation
in mind, which would be the process_result_value method of
this class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – Data to operate upon, of any type expected by
this method in the subclass.  Can be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</li>
<li><strong>dialect</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">Dialect</span></code> in use.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ws.db.sql_types.JSONEncodedDict.process_result_value">
<code class="descname">process_result_value</code><span class="sig-paren">(</span><em>value</em>, <em>dialect</em><span class="sig-paren">)</span><a class="headerlink" href="#ws.db.sql_types.JSONEncodedDict.process_result_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a result-row column value to be converted.</p>
<p>Subclasses should implement this method to operate on data
fetched from the database.</p>
<p>Subclasses override this method to return the
value that should be passed back to the application,
given a value that is already processed by
the underlying <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeEngine</span></code> object, originally
from the DBAPI cursor method <code class="docutils literal notranslate"><span class="pre">fetchone()</span></code> or similar.</p>
<p>The operation could be anything desired to perform custom
behavior, such as transforming or serializing data.
This could also be used as a hook for validating logic.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – Data to operate upon, of any type expected by
this method in the subclass.  Can be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</li>
<li><strong>dialect</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">Dialect</span></code> in use.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This operation should be designed to be reversible by
the “process_bind_param” method of this class.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/wiki-scripts.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">wiki-scripts</a></h1>










<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Writing new scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ws.html">ws package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="ws.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ws.ArchWiki.html">ws.ArchWiki package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ws.cache.html">ws.cache package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ws.client.html">ws.client package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="ws.db.html">ws.db package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ws.interlanguage.html">ws.interlanguage package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ws.parser_helpers.html">ws.parser_helpers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ws.utils.html">ws.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ws.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../modules.html">API reference</a><ul>
  <li><a href="ws.html">ws package</a><ul>
  <li><a href="ws.db.html">ws.db package</a><ul>
      <li>Previous: <a href="ws.db.schema.html" title="previous chapter">ws.db.schema module</a></li>
      <li>Next: <a href="ws.interlanguage.html" title="next chapter">ws.interlanguage package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014-2018, Jakub Klinkovský.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../_sources/ws/ws.db.sql_types.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/lahwaacz/wiki-scripts" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>